START TRANSACTION;

CREATE VIEW amostra AS 
	SELECT * FROM payments SAMPLE 3031;

CREATE VIEW VAC AS SELECT * FROM payments WHERE state = 'AC' SAMPLE 16;
CREATE VIEW VAL AS SELECT * FROM payments WHERE state = 'AL' SAMPLE 94;
CREATE VIEW VAM AS SELECT * FROM payments WHERE state = 'AM' SAMPLE 75;
CREATE VIEW VAP AS SELECT * FROM payments WHERE state = 'AP' SAMPLE 12;
CREATE VIEW VBA AS SELECT * FROM payments WHERE state = 'BA' SAMPLE 394;
CREATE VIEW VCE AS SELECT * FROM payments WHERE state = 'CE' SAMPLE 237;
CREATE VIEW VDF AS SELECT * FROM payments WHERE state = 'DF' SAMPLE 20;
CREATE VIEW VES AS SELECT * FROM payments WHERE state = 'ES' SAMPLE 42;
CREATE VIEW VGO AS SELECT * FROM payments WHERE state = 'GO' SAMPLE 73;
CREATE VIEW VMA AS SELECT * FROM payments WHERE state = 'MA' SAMPLE 210;
CREATE VIEW VMG AS SELECT * FROM payments WHERE state = 'MG' SAMPLE 252;
CREATE VIEW VMS AS SELECT * FROM payments WHERE state = 'MS' SAMPLE 31;
CREATE VIEW VMT AS SELECT * FROM payments WHERE state = 'MT' SAMPLE 39;
CREATE VIEW VPA AS SELECT * FROM payments WHERE state = 'PA' SAMPLE 185;
CREATE VIEW VPB AS SELECT * FROM payments WHERE state = 'PB' SAMPLE 112;
CREATE VIEW VPE AS SELECT * FROM payments WHERE state = 'PE' SAMPLE 250;
CREATE VIEW VPI AS SELECT * FROM payments WHERE state = 'PI' SAMPLE 99;
CREATE VIEW VPR AS SELECT * FROM payments WHERE state = 'PR' SAMPLE 93;
CREATE VIEW VRJ AS SELECT * FROM payments WHERE state = 'RJ' SAMPLE 176;
CREATE VIEW VRN AS SELECT * FROM payments WHERE state = 'RN' SAMPLE 78;
CREATE VIEW VRO AS SELECT * FROM payments WHERE state = 'RO' SAMPLE 24;
CREATE VIEW VRR AS SELECT * FROM payments WHERE state = 'RR' SAMPLE 10;
CREATE VIEW VRS AS SELECT * FROM payments WHERE state = 'RS' SAMPLE 96;
CREATE VIEW VSC AS SELECT * FROM payments WHERE state = 'SC' SAMPLE 30;
CREATE VIEW VSE AS SELECT * FROM payments WHERE state = 'SE' SAMPLE 59;
CREATE VIEW VSP AS SELECT * FROM payments WHERE state = 'SP' SAMPLE 292;
CREATE VIEW VTO AS SELECT * FROM payments WHERE state = 'TO' SAMPLE 30;

CREATE VIEW strat AS 
	SELECT * FROM VAC UNION ALL 
SELECT * FROM VAL UNION ALL 
SELECT * FROM VAM UNION ALL 
SELECT * FROM VAP UNION ALL 
SELECT * FROM VBA UNION ALL 
SELECT * FROM VCE UNION ALL 
SELECT * FROM VDF UNION ALL 
SELECT * FROM VES UNION ALL 
SELECT * FROM VGO UNION ALL 
SELECT * FROM VMA UNION ALL 
SELECT * FROM VMG UNION ALL 
SELECT * FROM VMS UNION ALL 
SELECT * FROM VMT UNION ALL 
SELECT * FROM VPA UNION ALL 
SELECT * FROM VPB UNION ALL 
SELECT * FROM VPE UNION ALL 
SELECT * FROM VPI UNION ALL 
SELECT * FROM VPR UNION ALL 
SELECT * FROM VRJ UNION ALL 
SELECT * FROM VRN UNION ALL 
SELECT * FROM VRO UNION ALL 
SELECT * FROM VRR UNION ALL 
SELECT * FROM VRS UNION ALL 
SELECT * FROM VSC UNION ALL 
SELECT * FROM VSE UNION ALL 
SELECT * FROM VSP UNION ALL 
SELECT * FROM VTO;

COPY select * from amostra INTO '/home/igorstemler/monet_sampling_benchmark/data/amostra.csv' USING DELIMITERS ',','\n' NULL AS '';
COPY select * from strat INTO '/home/igorstemler/monet_sampling_benchmark/data/strat.csv' USING DELIMITERS ',','\n' NULL AS '';

COMMIT;

